---
# host.1 = host array
# host.0 = icinga_host attribute
- name: icinga_host
  icinga_host:
    url: "{{ icinga_url }}"
    use_proxy: "{{ icinga_use_proxy | default(omit) }}"
    validate_certs: "{{ icinga_validate_certs | default(omit) }}"
    url_username: "{{ icinga_user }}"
    url_password: "{{ icinga_pass }}"
    force_basic_auth: "{{ icinga_force_basic_auth | default(omit) }}"
    client_cert: "{{ icinga_client_cert | default(omit) }}"
    client_key: "{{ icinga_client_key | default(omit) }}"
    state: "{{ host.0.state | default(omit) }}"
    object_name: "{{ host.1 }}"
    display_name: "{{ host.0.display_name | default(omit) }}"
    address: "{{ host.0.address | default(omit) }}"
    address6: "{{ host.0.address6 | default(omit) }}"
    groups: "{{ host.0.groups | default(omit) }}"
    disabled: "{{ host.0.disabled | default(omit) }}"
    imports: "{{ host.0.imports | default(icinga_host_imports) }}"
    zone: "{{ host.0.zone | default(omit) }}"
    vars: "{{ host.0.vars | default(omit) }}"
    notes: "{{ host.0.notes | default(omit) }}"
    notes_url: "{{ host.0.notes_url | default(omit) }}"
    has_agent: "{{ host.0.has_agent | default(omit) }}"
    master_should_connect: "{{ host.0.master_should_connect | default(omit) }}"
    accept_config: "{{ host.0.accept_config | default(omit) }}"
  loop: "{{ icinga_hosts|subelements('host_object') }}"
  loop_control:
    loop_var: host
  tags: host
